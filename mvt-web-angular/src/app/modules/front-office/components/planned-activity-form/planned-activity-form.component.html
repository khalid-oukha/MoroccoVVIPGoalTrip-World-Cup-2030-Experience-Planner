<!-- planned-activity-form.component.html with error handling -->
<form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-4">
  <div>
    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Priority</label>
    <select formControlName="priority" class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 py-2 px-3 text-gray-900 dark:text-gray-100">
      <option value="low">Low</option>
      <option value="medium">Medium</option>
      <option value="high">High</option>
    </select>
    <div *ngIf="form.get('priority')?.invalid && (form.get('priority')?.dirty || form.get('priority')?.touched || formSubmitted)"
         class="mt-1 text-xs text-red-500">
      Priority is required
    </div>
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Start Date & Time</label>
    <input
      type="datetime-local"
      formControlName="startDate"
      class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 py-2 px-3 text-gray-900 dark:text-gray-100"
    >
    <div *ngIf="form.get('startDate')?.invalid && (form.get('startDate')?.dirty || form.get('startDate')?.touched || formSubmitted)"
         class="mt-1 text-xs text-red-500">
      Start date and time is required
    </div>
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">End Date & Time</label>
    <input
      type="datetime-local"
      formControlName="endDate"
      class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 py-2 px-3 text-gray-900 dark:text-gray-100"
    >
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Notes</label>
    <textarea
      formControlName="notes"
      class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 py-2 px-3 text-gray-900 dark:text-gray-100"
      rows="3"
    ></textarea>
  </div>

  <!-- General form error message -->
  <div *ngIf="errorMessage" class="p-2 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm rounded-md">
    {{ errorMessage }}
  </div>

  <div class="flex justify-end gap-2 mt-6">
    <button
      type="button"
      (click)="onCancel()"
      class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md border border-gray-300 dark:border-gray-600"
    >
      Cancel
    </button>
    <button
      type="submit"
      [disabled]="form.invalid || isSubmitting"
      class="px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-primary/90 disabled:opacity-50"
    >
      <span *ngIf="isSubmitting" class="inline-block animate-spin mr-1">â†»</span>
      Save Changes
    </button>
  </div>
</form>
